{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "c21d5e77",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-08-05T02:35:20.360291Z",
     "iopub.status.busy": "2024-08-05T02:35:20.359984Z",
     "iopub.status.idle": "2024-08-05T02:35:36.775992Z",
     "shell.execute_reply": "2024-08-05T02:35:36.775156Z"
    },
    "papermill": {
     "duration": 16.424965,
     "end_time": "2024-08-05T02:35:36.778133",
     "exception": false,
     "start_time": "2024-08-05T02:35:20.353168",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING: Logging before InitGoogle() is written to STDERR\n",
      "E0000 00:00:1722825327.191782      77 common_lib.cc:798] Could not set metric server port: INVALID_ARGUMENT: Could not find SliceBuilder port 8471 in any of the 0 ports provided in `tpu_process_addresses`=\"local\"\n",
      "=== Source Location Trace: ===\n",
      "learning/45eac/tfrc/runtime/common_lib.cc:479\n",
      "D0805 02:35:27.200666148      77 config.cc:196]                        gRPC EXPERIMENT call_status_override_on_cancellation   OFF (default:OFF)\n",
      "D0805 02:35:27.200683734      77 config.cc:196]                        gRPC EXPERIMENT call_v3                                OFF (default:OFF)\n",
      "D0805 02:35:27.200687463      77 config.cc:196]                        gRPC EXPERIMENT canary_client_privacy                  ON  (default:ON)\n",
      "D0805 02:35:27.200690465      77 config.cc:196]                        gRPC EXPERIMENT capture_base_context                   ON  (default:ON)\n",
      "D0805 02:35:27.200693190      77 config.cc:196]                        gRPC EXPERIMENT client_idleness                        ON  (default:ON)\n",
      "D0805 02:35:27.200695826      77 config.cc:196]                        gRPC EXPERIMENT client_privacy                         ON  (default:ON)\n",
      "D0805 02:35:27.200698420      77 config.cc:196]                        gRPC EXPERIMENT dapper_request_wire_size               OFF (default:OFF)\n",
      "D0805 02:35:27.200713298      77 config.cc:196]                        gRPC EXPERIMENT empty_experiment                       OFF (default:OFF)\n",
      "D0805 02:35:27.200715605      77 config.cc:196]                        gRPC EXPERIMENT event_engine_client                    OFF (default:OFF)\n",
      "D0805 02:35:27.200717855      77 config.cc:196]                        gRPC EXPERIMENT event_engine_dns                       ON  (default:ON)\n",
      "D0805 02:35:27.200720285      77 config.cc:196]                        gRPC EXPERIMENT event_engine_listener                  ON  (default:ON)\n",
      "D0805 02:35:27.200722898      77 config.cc:196]                        gRPC EXPERIMENT free_large_allocator                   OFF (default:OFF)\n",
      "D0805 02:35:27.200725199      77 config.cc:196]                        gRPC EXPERIMENT google_no_envelope_resolver            OFF (default:OFF)\n",
      "D0805 02:35:27.200727481      77 config.cc:196]                        gRPC EXPERIMENT http2_stats_fix                        OFF (default:OFF)\n",
      "D0805 02:35:27.200729763      77 config.cc:196]                        gRPC EXPERIMENT keepalive_fix                          OFF (default:OFF)\n",
      "D0805 02:35:27.200732044      77 config.cc:196]                        gRPC EXPERIMENT keepalive_server_fix                   ON  (default:ON)\n",
      "D0805 02:35:27.200734515      77 config.cc:196]                        gRPC EXPERIMENT loas_do_not_prefer_rekey_next_protocol OFF (default:OFF)\n",
      "D0805 02:35:27.200736971      77 config.cc:196]                        gRPC EXPERIMENT loas_prod_to_cloud_prefer_pfs_ciphers  OFF (default:OFF)\n",
      "D0805 02:35:27.200739281      77 config.cc:196]                        gRPC EXPERIMENT monitoring_experiment                  ON  (default:ON)\n",
      "D0805 02:35:27.200741619      77 config.cc:196]                        gRPC EXPERIMENT multiping                              OFF (default:OFF)\n",
      "D0805 02:35:27.200743907      77 config.cc:196]                        gRPC EXPERIMENT peer_state_based_framing               OFF (default:OFF)\n",
      "D0805 02:35:27.200746201      77 config.cc:196]                        gRPC EXPERIMENT pending_queue_cap                      ON  (default:ON)\n",
      "D0805 02:35:27.200748593      77 config.cc:196]                        gRPC EXPERIMENT pick_first_happy_eyeballs              ON  (default:ON)\n",
      "D0805 02:35:27.200750901      77 config.cc:196]                        gRPC EXPERIMENT promise_based_client_call              OFF (default:OFF)\n",
      "D0805 02:35:27.200753149      77 config.cc:196]                        gRPC EXPERIMENT promise_based_inproc_transport         OFF (default:OFF)\n",
      "D0805 02:35:27.200755401      77 config.cc:196]                        gRPC EXPERIMENT promise_based_server_call              OFF (default:OFF)\n",
      "D0805 02:35:27.200757756      77 config.cc:196]                        gRPC EXPERIMENT registered_method_lookup_in_transport  ON  (default:ON)\n",
      "D0805 02:35:27.200760059      77 config.cc:196]                        gRPC EXPERIMENT rfc_max_concurrent_streams             ON  (default:ON)\n",
      "D0805 02:35:27.200762489      77 config.cc:196]                        gRPC EXPERIMENT round_robin_delegate_to_pick_first     ON  (default:ON)\n",
      "D0805 02:35:27.200765930      77 config.cc:196]                        gRPC EXPERIMENT rstpit                                 OFF (default:OFF)\n",
      "D0805 02:35:27.200768489      77 config.cc:196]                        gRPC EXPERIMENT schedule_cancellation_over_write       OFF (default:OFF)\n",
      "D0805 02:35:27.200770943      77 config.cc:196]                        gRPC EXPERIMENT server_privacy                         ON  (default:ON)\n",
      "D0805 02:35:27.200773418      77 config.cc:196]                        gRPC EXPERIMENT tcp_frame_size_tuning                  OFF (default:OFF)\n",
      "D0805 02:35:27.200775740      77 config.cc:196]                        gRPC EXPERIMENT tcp_rcv_lowat                          OFF (default:OFF)\n",
      "D0805 02:35:27.200778041      77 config.cc:196]                        gRPC EXPERIMENT trace_record_callops                   OFF (default:OFF)\n",
      "D0805 02:35:27.200780332      77 config.cc:196]                        gRPC EXPERIMENT unconstrained_max_quota_buffer_size    OFF (default:OFF)\n",
      "D0805 02:35:27.200782573      77 config.cc:196]                        gRPC EXPERIMENT v3_backend_metric_filter               OFF (default:OFF)\n",
      "D0805 02:35:27.200784856      77 config.cc:196]                        gRPC EXPERIMENT v3_channel_idle_filters                ON  (default:ON)\n",
      "D0805 02:35:27.200787208      77 config.cc:196]                        gRPC EXPERIMENT v3_compression_filter                  ON  (default:ON)\n",
      "D0805 02:35:27.200789537      77 config.cc:196]                        gRPC EXPERIMENT v3_server_auth_filter                  OFF (default:OFF)\n",
      "D0805 02:35:27.200791836      77 config.cc:196]                        gRPC EXPERIMENT work_serializer_clears_time_cache      OFF (default:OFF)\n",
      "D0805 02:35:27.200794084      77 config.cc:196]                        gRPC EXPERIMENT work_serializer_dispatch               OFF (default:OFF)\n",
      "D0805 02:35:27.200796400      77 config.cc:196]                        gRPC EXPERIMENT write_size_cap                         ON  (default:ON)\n",
      "D0805 02:35:27.200798766      77 config.cc:196]                        gRPC EXPERIMENT write_size_policy                      ON  (default:ON)\n",
      "D0805 02:35:27.200801131      77 config.cc:196]                        gRPC EXPERIMENT wrr_delegate_to_pick_first             ON  (default:ON)\n",
      "I0805 02:35:27.201013221      77 ev_epoll1_linux.cc:123]               grpc epoll fd: 56\n",
      "D0805 02:35:27.201025977      77 ev_posix.cc:113]                      Using polling engine: epoll1\n",
      "D0805 02:35:27.214140845      77 lb_policy_registry.cc:46]             registering LB policy factory for \"priority_experimental\"\n",
      "D0805 02:35:27.214154835      77 lb_policy_registry.cc:46]             registering LB policy factory for \"outlier_detection_experimental\"\n",
      "D0805 02:35:27.214163931      77 lb_policy_registry.cc:46]             registering LB policy factory for \"weighted_target_experimental\"\n",
      "D0805 02:35:27.214167586      77 lb_policy_registry.cc:46]             registering LB policy factory for \"pick_first\"\n",
      "D0805 02:35:27.214171207      77 lb_policy_registry.cc:46]             registering LB policy factory for \"round_robin\"\n",
      "D0805 02:35:27.214174504      77 lb_policy_registry.cc:46]             registering LB policy factory for \"weighted_round_robin\"\n",
      "D0805 02:35:27.214203226      77 lb_policy_registry.cc:46]             registering LB policy factory for \"grpclb\"\n",
      "D0805 02:35:27.214221112      77 dns_resolver_plugin.cc:43]            Using EventEngine dns resolver\n",
      "D0805 02:35:27.214239134      77 lb_policy_registry.cc:46]             registering LB policy factory for \"rls_experimental\"\n",
      "D0805 02:35:27.214262755      77 lb_policy_registry.cc:46]             registering LB policy factory for \"xds_cluster_manager_experimental\"\n",
      "D0805 02:35:27.214271717      77 lb_policy_registry.cc:46]             registering LB policy factory for \"xds_cluster_impl_experimental\"\n",
      "D0805 02:35:27.214275340      77 lb_policy_registry.cc:46]             registering LB policy factory for \"cds_experimental\"\n",
      "D0805 02:35:27.214279834      77 lb_policy_registry.cc:46]             registering LB policy factory for \"xds_override_host_experimental\"\n",
      "D0805 02:35:27.214286303      77 lb_policy_registry.cc:46]             registering LB policy factory for \"xds_wrr_locality_experimental\"\n",
      "D0805 02:35:27.214289760      77 lb_policy_registry.cc:46]             registering LB policy factory for \"ring_hash_experimental\"\n",
      "D0805 02:35:27.214293403      77 certificate_provider_registry.cc:33]  registering certificate provider factory for \"file_watcher\"\n",
      "D0805 02:35:27.214324002      77 channel_init.cc:157]                  Filter server-auth not registered, but is referenced in the after clause of grpc-server-authz when building channel stack SERVER_CHANNEL\n",
      "I0805 02:35:27.216317780      77 ev_epoll1_linux.cc:359]               grpc epoll fd: 58\n",
      "I0805 02:35:27.217462891      77 tcp_socket_utils.cc:689]              Disabling AF_INET6 sockets because ::1 is not available.\n",
      "I0805 02:35:27.220942408     174 socket_utils_common_posix.cc:452]     Disabling AF_INET6 sockets because ::1 is not available.\n",
      "I0805 02:35:27.220999549     174 socket_utils_common_posix.cc:379]     TCP_USER_TIMEOUT is available. TCP_USER_TIMEOUT will be used thereafter\n",
      "E0805 02:35:27.227568824      77 oauth2_credentials.cc:238]            oauth_fetch: UNKNOWN:C-ares status is not ARES_SUCCESS qtype=A name=metadata.google.internal. is_balancer=0: Domain name not found {created_time:\"2024-08-05T02:35:27.227552834+00:00\", grpc_status:2}\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/usr/local/lib/python3.10/site-packages/tqdm/auto.py:21: TqdmWarning: IProgress not found. Please update jupyter and ipywidgets. See https://ipywidgets.readthedocs.io/en/stable/user_install.html\n",
      "  from .autonotebook import tqdm as notebook_tqdm\n"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "import keras\n",
    "import keras_nlp\n",
    "import tensorflow as tf\n",
    "from sklearn.model_selection import train_test_split\n",
    "from matplotlib import pyplot as plt"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "11d9c70a",
   "metadata": {
    "papermill": {
     "duration": 0.004531,
     "end_time": "2024-08-05T02:35:36.787104",
     "exception": false,
     "start_time": "2024-08-05T02:35:36.782573",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Load Train Data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "4dc04c3e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-08-05T02:35:36.797199Z",
     "iopub.status.busy": "2024-08-05T02:35:36.796714Z",
     "iopub.status.idle": "2024-08-05T02:35:44.188925Z",
     "shell.execute_reply": "2024-08-05T02:35:44.188238Z"
    },
    "papermill": {
     "duration": 7.399488,
     "end_time": "2024-08-05T02:35:44.190680",
     "exception": false,
     "start_time": "2024-08-05T02:35:36.791192",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>model_a</th>\n",
       "      <th>model_b</th>\n",
       "      <th>prompt</th>\n",
       "      <th>response_a</th>\n",
       "      <th>response_b</th>\n",
       "      <th>winner_model_a</th>\n",
       "      <th>winner_model_b</th>\n",
       "      <th>winner_tie</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>30192</td>\n",
       "      <td>gpt-4-1106-preview</td>\n",
       "      <td>gpt-4-0613</td>\n",
       "      <td>Is it morally right to try to have a certain p...</td>\n",
       "      <td>The question of whether it is morally right to...</td>\n",
       "      <td>As an AI, I don't have personal beliefs or opi...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>53567</td>\n",
       "      <td>koala-13b</td>\n",
       "      <td>gpt-4-0613</td>\n",
       "      <td>What is the difference between marriage licens...</td>\n",
       "      <td>A marriage license is a legal document that al...</td>\n",
       "      <td>A marriage license and a marriage certificate ...</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>65089</td>\n",
       "      <td>gpt-3.5-turbo-0613</td>\n",
       "      <td>mistral-medium</td>\n",
       "      <td>explain function calling. how would you call a...</td>\n",
       "      <td>Function calling is the process of invoking or...</td>\n",
       "      <td>Function calling is the process of invoking a ...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>96401</td>\n",
       "      <td>llama-2-13b-chat</td>\n",
       "      <td>mistral-7b-instruct</td>\n",
       "      <td>How can I create a test set for a very rare ca...</td>\n",
       "      <td>Creating a test set for a very rare category c...</td>\n",
       "      <td>When building a classifier for a very rare cat...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>198779</td>\n",
       "      <td>koala-13b</td>\n",
       "      <td>gpt-3.5-turbo-0314</td>\n",
       "      <td>What is the best way to travel from Tel-Aviv t...</td>\n",
       "      <td>The best way to travel from Tel Aviv to Jerusa...</td>\n",
       "      <td>The best way to travel from Tel-Aviv to Jerusa...</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       id             model_a              model_b  \\\n",
       "0   30192  gpt-4-1106-preview           gpt-4-0613   \n",
       "1   53567           koala-13b           gpt-4-0613   \n",
       "2   65089  gpt-3.5-turbo-0613       mistral-medium   \n",
       "3   96401    llama-2-13b-chat  mistral-7b-instruct   \n",
       "4  198779           koala-13b   gpt-3.5-turbo-0314   \n",
       "\n",
       "                                              prompt  \\\n",
       "0  Is it morally right to try to have a certain p...   \n",
       "1  What is the difference between marriage licens...   \n",
       "2  explain function calling. how would you call a...   \n",
       "3  How can I create a test set for a very rare ca...   \n",
       "4  What is the best way to travel from Tel-Aviv t...   \n",
       "\n",
       "                                          response_a  \\\n",
       "0  The question of whether it is morally right to...   \n",
       "1  A marriage license is a legal document that al...   \n",
       "2  Function calling is the process of invoking or...   \n",
       "3  Creating a test set for a very rare category c...   \n",
       "4  The best way to travel from Tel Aviv to Jerusa...   \n",
       "\n",
       "                                          response_b  winner_model_a  \\\n",
       "0  As an AI, I don't have personal beliefs or opi...               1   \n",
       "1  A marriage license and a marriage certificate ...               0   \n",
       "2  Function calling is the process of invoking a ...               0   \n",
       "3  When building a classifier for a very rare cat...               1   \n",
       "4  The best way to travel from Tel-Aviv to Jerusa...               0   \n",
       "\n",
       "   winner_model_b  winner_tie  \n",
       "0               0           0  \n",
       "1               1           0  \n",
       "2               0           1  \n",
       "3               0           0  \n",
       "4               1           0  "
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Load Kaggle Base Folder\n",
    "base_dir = '/kaggle/input/lmsys-chatbot-arena/'\n",
    "\n",
    "# Load Train Data\n",
    "df = pd.read_csv(base_dir + 'train.csv')\n",
    "\n",
    "# Parse String and Ensure all text data is encoded to UTF-8\n",
    "for col in [i for i in df.columns if i in ['prompt', 'response_a', 'response_b']]:\n",
    "    df[col] = df[col].map(lambda x: eval(x.replace(\"null\", \"''\"))[0])\n",
    "    df[col] = df[col].apply(lambda x: str(x).encode('utf-8', errors='ignore').decode('utf-8'))\n",
    "\n",
    "# Show Sample\n",
    "df.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cf8d02ae",
   "metadata": {
    "papermill": {
     "duration": 0.004368,
     "end_time": "2024-08-05T02:35:44.199863",
     "exception": false,
     "start_time": "2024-08-05T02:35:44.195495",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Create Label"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "4f8bf121",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-08-05T02:35:44.210260Z",
     "iopub.status.busy": "2024-08-05T02:35:44.209963Z",
     "iopub.status.idle": "2024-08-05T02:35:44.226298Z",
     "shell.execute_reply": "2024-08-05T02:35:44.225577Z"
    },
    "papermill": {
     "duration": 0.02388,
     "end_time": "2024-08-05T02:35:44.228118",
     "exception": false,
     "start_time": "2024-08-05T02:35:44.204238",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# Create label dictionary for mapping\n",
    "label_map = {'winner_model_a': 0, 'winner_model_b': 1, 'winner_tie': 2}\n",
    "\n",
    "# Map column into label\n",
    "df['label'] = df[['winner_model_a', 'winner_model_b', 'winner_tie']].idxmax(axis=1).map(label_map)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ca9363a3",
   "metadata": {
    "papermill": {
     "duration": 0.004572,
     "end_time": "2024-08-05T02:35:44.236906",
     "exception": false,
     "start_time": "2024-08-05T02:35:44.232334",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Tokenizer & Preprocessor"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "762b1d2f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-08-05T02:35:44.247419Z",
     "iopub.status.busy": "2024-08-05T02:35:44.247176Z",
     "iopub.status.idle": "2024-08-05T02:35:55.974053Z",
     "shell.execute_reply": "2024-08-05T02:35:55.972938Z"
    },
    "papermill": {
     "duration": 11.734693,
     "end_time": "2024-08-05T02:35:55.976157",
     "exception": false,
     "start_time": "2024-08-05T02:35:44.241464",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Attaching 'model.safetensors' from model 'keras/bert/keras/bert_small_en_uncased/2' to your Kaggle notebook...\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Attaching 'model.safetensors.index.json' from model 'keras/bert/keras/bert_small_en_uncased/2' to your Kaggle notebook...\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Attaching 'metadata.json' from model 'keras/bert/keras/bert_small_en_uncased/2' to your Kaggle notebook...\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Attaching 'metadata.json' from model 'keras/bert/keras/bert_small_en_uncased/2' to your Kaggle notebook...\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Attaching 'tokenizer.json' from model 'keras/bert/keras/bert_small_en_uncased/2' to your Kaggle notebook...\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Attaching 'tokenizer.json' from model 'keras/bert/keras/bert_small_en_uncased/2' to your Kaggle notebook...\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Attaching 'assets/tokenizer/vocabulary.txt' from model 'keras/bert/keras/bert_small_en_uncased/2' to your Kaggle notebook...\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING: All log messages before absl::InitializeLog() is called are written to STDERR\n",
      "I0000 00:00:1722825355.903975      77 service.cc:145] XLA service 0x5950b8ce4650 initialized for platform TPU (this does not guarantee that XLA will be used). Devices:\n",
      "I0000 00:00:1722825355.904035      77 service.cc:153]   StreamExecutor device (0): TPU, 2a886c8\n",
      "I0000 00:00:1722825355.904040      77 service.cc:153]   StreamExecutor device (1): TPU, 2a886c8\n",
      "I0000 00:00:1722825355.904043      77 service.cc:153]   StreamExecutor device (2): TPU, 2a886c8\n",
      "I0000 00:00:1722825355.904046      77 service.cc:153]   StreamExecutor device (3): TPU, 2a886c8\n",
      "I0000 00:00:1722825355.904049      77 service.cc:153]   StreamExecutor device (4): TPU, 2a886c8\n",
      "I0000 00:00:1722825355.904051      77 service.cc:153]   StreamExecutor device (5): TPU, 2a886c8\n",
      "I0000 00:00:1722825355.904054      77 service.cc:153]   StreamExecutor device (6): TPU, 2a886c8\n",
      "I0000 00:00:1722825355.904057      77 service.cc:153]   StreamExecutor device (7): TPU, 2a886c8\n"
     ]
    }
   ],
   "source": [
    "tokenizer = keras_nlp.models.BertTokenizer.from_preset(\n",
    "    \"bert_small_en_uncased\",\n",
    ")\n",
    "\n",
    "preprocessor = keras_nlp.models.BertPreprocessor(\n",
    "    tokenizer=tokenizer,\n",
    "    sequence_length=512\n",
    ")\n",
    "\n",
    "# Update preprocess_fn to handle multiple inputs and return additional features\n",
    "def preprocess_fn(prompt, response_a, response_b, label=None):\n",
    "    prompt = preprocessor(prompt)\n",
    "    response_a = preprocessor(response_a)\n",
    "    response_b = preprocessor(response_b)\n",
    "    inputs = {\n",
    "        'prompt_input': prompt['token_ids'],\n",
    "        'prompt_segment_ids': prompt['segment_ids'],\n",
    "        'prompt_padding_mask': prompt['padding_mask'],\n",
    "        'response_a_input': response_a['token_ids'],\n",
    "        'response_a_segment_ids': response_a['segment_ids'],\n",
    "        'response_a_padding_mask': response_a['padding_mask'],\n",
    "        'response_b_input': response_b['token_ids'],\n",
    "        'response_b_segment_ids': response_b['segment_ids'],\n",
    "        'response_b_padding_mask': response_b['padding_mask'],\n",
    "    }\n",
    "    return (inputs, label) if label is not None else inputs\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3a63faa8",
   "metadata": {
    "papermill": {
     "duration": 0.005173,
     "end_time": "2024-08-05T02:35:55.986316",
     "exception": false,
     "start_time": "2024-08-05T02:35:55.981143",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Build Dataset"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "cdcbca05",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-08-05T02:35:55.997392Z",
     "iopub.status.busy": "2024-08-05T02:35:55.997085Z",
     "iopub.status.idle": "2024-08-05T02:35:56.002720Z",
     "shell.execute_reply": "2024-08-05T02:35:56.001913Z"
    },
    "papermill": {
     "duration": 0.013339,
     "end_time": "2024-08-05T02:35:56.004312",
     "exception": false,
     "start_time": "2024-08-05T02:35:55.990973",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# Update build_dataset function\n",
    "def build_dataset(prompts, responses_a, responses_b, labels=None, batch_size=16, shuffle=True):\n",
    "    slices = (prompts, responses_a, responses_b, keras.utils.to_categorical(labels, num_classes=3)) if labels is not None else (prompts, responses_a, responses_b)\n",
    "    ds = tf.data.Dataset.from_tensor_slices(slices)\n",
    "    ds = ds.map(preprocess_fn, num_parallel_calls=tf.data.AUTOTUNE)\n",
    "    if shuffle:\n",
    "        ds = ds.shuffle(buffer_size=10000)\n",
    "    ds = ds.batch(batch_size)\n",
    "    ds = ds.prefetch(tf.data.AUTOTUNE)\n",
    "    return ds"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "5afb6fcb",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-08-05T02:35:56.015399Z",
     "iopub.status.busy": "2024-08-05T02:35:56.015126Z",
     "iopub.status.idle": "2024-08-05T02:36:02.952802Z",
     "shell.execute_reply": "2024-08-05T02:36:02.951508Z"
    },
    "papermill": {
     "duration": 6.945859,
     "end_time": "2024-08-05T02:36:02.955188",
     "exception": false,
     "start_time": "2024-08-05T02:35:56.009329",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "train_df, val_df = train_test_split(df, test_size=0.2, stratify=df.label)\n",
    "\n",
    "# Build the datasets\n",
    "train_dataset = build_dataset(\n",
    "    prompts=train_df.prompt.tolist(),\n",
    "    responses_a=train_df.response_a.tolist(),\n",
    "    responses_b=train_df.response_b.tolist(),\n",
    "    labels=train_df.label.tolist(),\n",
    "    batch_size=64,\n",
    "    shuffle=True\n",
    ")\n",
    "\n",
    "val_dataset = build_dataset(\n",
    "    prompts=val_df.prompt.tolist(),\n",
    "    responses_a=val_df.response_a.tolist(),\n",
    "    responses_b=val_df.response_b.tolist(),\n",
    "    labels=val_df.label.tolist(),\n",
    "    batch_size=64,\n",
    "    shuffle=False\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7ad0c470",
   "metadata": {
    "papermill": {
     "duration": 0.004777,
     "end_time": "2024-08-05T02:36:02.965160",
     "exception": false,
     "start_time": "2024-08-05T02:36:02.960383",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Modeling"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "a117ea01",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-08-05T02:36:02.976499Z",
     "iopub.status.busy": "2024-08-05T02:36:02.976164Z",
     "iopub.status.idle": "2024-08-05T02:36:07.862834Z",
     "shell.execute_reply": "2024-08-05T02:36:07.861851Z"
    },
    "papermill": {
     "duration": 4.894728,
     "end_time": "2024-08-05T02:36:07.864913",
     "exception": false,
     "start_time": "2024-08-05T02:36:02.970185",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "INFO:tensorflow:Deallocate tpu buffers before initializing tpu system.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "INFO:tensorflow:Initializing the TPU system: local\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "INFO:tensorflow:Finished initializing TPU system.\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:`tf.distribute.experimental.TPUStrategy` is deprecated, please use the non-experimental symbol `tf.distribute.TPUStrategy` instead.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "INFO:tensorflow:Found TPU system:\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:tensorflow:Found TPU system:\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "INFO:tensorflow:*** Num TPU Cores: 8\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:tensorflow:*** Num TPU Cores: 8\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "INFO:tensorflow:*** Num TPU Workers: 1\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:tensorflow:*** Num TPU Workers: 1\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "INFO:tensorflow:*** Num TPU Cores Per Worker: 8\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:tensorflow:*** Num TPU Cores Per Worker: 8\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:TPU:0, TPU, 0, 0)\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:TPU:0, TPU, 0, 0)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:TPU:1, TPU, 0, 0)\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:TPU:1, TPU, 0, 0)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:TPU:2, TPU, 0, 0)\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:TPU:2, TPU, 0, 0)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:TPU:3, TPU, 0, 0)\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:TPU:3, TPU, 0, 0)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:TPU:4, TPU, 0, 0)\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:TPU:4, TPU, 0, 0)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:TPU:5, TPU, 0, 0)\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:TPU:5, TPU, 0, 0)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:TPU:6, TPU, 0, 0)\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:TPU:6, TPU, 0, 0)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:TPU:7, TPU, 0, 0)\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:TPU:7, TPU, 0, 0)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)\n"
     ]
    }
   ],
   "source": [
    "try:\n",
    "    tpu = tf.distribute.cluster_resolver.TPUClusterResolver()\n",
    "    tf.config.experimental_connect_to_cluster(tpu)\n",
    "    tf.tpu.experimental.initialize_tpu_system(tpu)\n",
    "    tpu_strategy = tf.distribute.experimental.TPUStrategy(tpu)\n",
    "except ValueError:\n",
    "    tpu_strategy = tf.distribute.get_strategy()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1210ecb2",
   "metadata": {
    "papermill": {
     "duration": 0.006968,
     "end_time": "2024-08-05T02:36:07.879281",
     "exception": false,
     "start_time": "2024-08-05T02:36:07.872313",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Train"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "2eaa7855",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-08-05T02:36:07.894562Z",
     "iopub.status.busy": "2024-08-05T02:36:07.894271Z",
     "iopub.status.idle": "2024-08-05T02:36:18.836601Z",
     "shell.execute_reply": "2024-08-05T02:36:18.835667Z"
    },
    "papermill": {
     "duration": 10.951996,
     "end_time": "2024-08-05T02:36:18.838340",
     "exception": false,
     "start_time": "2024-08-05T02:36:07.886344",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Attaching 'model.safetensors' from model 'keras/bert/keras/bert_small_en_uncased/2' to your Kaggle notebook...\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Attaching 'model.safetensors.index.json' from model 'keras/bert/keras/bert_small_en_uncased/2' to your Kaggle notebook...\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Attaching 'metadata.json' from model 'keras/bert/keras/bert_small_en_uncased/2' to your Kaggle notebook...\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Attaching 'metadata.json' from model 'keras/bert/keras/bert_small_en_uncased/2' to your Kaggle notebook...\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Attaching 'config.json' from model 'keras/bert/keras/bert_small_en_uncased/2' to your Kaggle notebook...\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Attaching 'config.json' from model 'keras/bert/keras/bert_small_en_uncased/2' to your Kaggle notebook...\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Attaching 'model.weights.h5' from model 'keras/bert/keras/bert_small_en_uncased/2' to your Kaggle notebook...\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "I0000 00:00:1722825378.406857      77 device_compiler.h:188] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"font-weight: bold\">Model: \"functional\"</span>\n",
       "</pre>\n"
      ],
      "text/plain": [
       "\u001b[1mModel: \"functional\"\u001b[0m\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓\n",
       "┃<span style=\"font-weight: bold\"> Layer (type)        </span>┃<span style=\"font-weight: bold\"> Output Shape      </span>┃<span style=\"font-weight: bold\">    Param # </span>┃<span style=\"font-weight: bold\"> Connected to      </span>┃\n",
       "┡━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩\n",
       "│ prompt_padding_mask │ (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">512</span>)       │          <span style=\"color: #00af00; text-decoration-color: #00af00\">0</span> │ -                 │\n",
       "│ (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">InputLayer</span>)        │                   │            │                   │\n",
       "├─────────────────────┼───────────────────┼────────────┼───────────────────┤\n",
       "│ prompt_segment_ids  │ (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">512</span>)       │          <span style=\"color: #00af00; text-decoration-color: #00af00\">0</span> │ -                 │\n",
       "│ (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">InputLayer</span>)        │                   │            │                   │\n",
       "├─────────────────────┼───────────────────┼────────────┼───────────────────┤\n",
       "│ prompt_input        │ (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">512</span>)       │          <span style=\"color: #00af00; text-decoration-color: #00af00\">0</span> │ -                 │\n",
       "│ (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">InputLayer</span>)        │                   │            │                   │\n",
       "├─────────────────────┼───────────────────┼────────────┼───────────────────┤\n",
       "│ response_a_padding… │ (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">512</span>)       │          <span style=\"color: #00af00; text-decoration-color: #00af00\">0</span> │ -                 │\n",
       "│ (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">InputLayer</span>)        │                   │            │                   │\n",
       "├─────────────────────┼───────────────────┼────────────┼───────────────────┤\n",
       "│ response_a_segment… │ (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">512</span>)       │          <span style=\"color: #00af00; text-decoration-color: #00af00\">0</span> │ -                 │\n",
       "│ (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">InputLayer</span>)        │                   │            │                   │\n",
       "├─────────────────────┼───────────────────┼────────────┼───────────────────┤\n",
       "│ response_a_input    │ (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">512</span>)       │          <span style=\"color: #00af00; text-decoration-color: #00af00\">0</span> │ -                 │\n",
       "│ (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">InputLayer</span>)        │                   │            │                   │\n",
       "├─────────────────────┼───────────────────┼────────────┼───────────────────┤\n",
       "│ response_b_padding… │ (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">512</span>)       │          <span style=\"color: #00af00; text-decoration-color: #00af00\">0</span> │ -                 │\n",
       "│ (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">InputLayer</span>)        │                   │            │                   │\n",
       "├─────────────────────┼───────────────────┼────────────┼───────────────────┤\n",
       "│ response_b_segment… │ (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">512</span>)       │          <span style=\"color: #00af00; text-decoration-color: #00af00\">0</span> │ -                 │\n",
       "│ (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">InputLayer</span>)        │                   │            │                   │\n",
       "├─────────────────────┼───────────────────┼────────────┼───────────────────┤\n",
       "│ response_b_input    │ (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">512</span>)       │          <span style=\"color: #00af00; text-decoration-color: #00af00\">0</span> │ -                 │\n",
       "│ (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">InputLayer</span>)        │                   │            │                   │\n",
       "├─────────────────────┼───────────────────┼────────────┼───────────────────┤\n",
       "│ bert_backbone       │ [(<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">512</span>),     │ <span style=\"color: #00af00; text-decoration-color: #00af00\">28,763,648</span> │ prompt_padding_m… │\n",
       "│ (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">BertBackbone</span>)      │ (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">512</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">512</span>)] │            │ prompt_segment_i… │\n",
       "│                     │                   │            │ prompt_input[<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>][<span style=\"color: #00af00; text-decoration-color: #00af00\">…</span> │\n",
       "│                     │                   │            │ response_a_paddi… │\n",
       "│                     │                   │            │ response_a_segme… │\n",
       "│                     │                   │            │ response_a_input… │\n",
       "│                     │                   │            │ response_b_paddi… │\n",
       "│                     │                   │            │ response_b_segme… │\n",
       "│                     │                   │            │ response_b_input… │\n",
       "├─────────────────────┼───────────────────┼────────────┼───────────────────┤\n",
       "│ attention           │ (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">512</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">512</span>)  │          <span style=\"color: #00af00; text-decoration-color: #00af00\">0</span> │ bert_backbone[<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>]… │\n",
       "│ (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Attention</span>)         │                   │            │ bert_backbone[<span style=\"color: #00af00; text-decoration-color: #00af00\">1</span>]… │\n",
       "├─────────────────────┼───────────────────┼────────────┼───────────────────┤\n",
       "│ attention_1         │ (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">512</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">512</span>)  │          <span style=\"color: #00af00; text-decoration-color: #00af00\">0</span> │ bert_backbone[<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>]… │\n",
       "│ (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Attention</span>)         │                   │            │ bert_backbone[<span style=\"color: #00af00; text-decoration-color: #00af00\">2</span>]… │\n",
       "├─────────────────────┼───────────────────┼────────────┼───────────────────┤\n",
       "│ global_average_poo… │ (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">512</span>)       │          <span style=\"color: #00af00; text-decoration-color: #00af00\">0</span> │ attention[<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>][<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>]   │\n",
       "│ (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">GlobalAveragePool…</span> │                   │            │                   │\n",
       "├─────────────────────┼───────────────────┼────────────┼───────────────────┤\n",
       "│ global_average_poo… │ (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">512</span>)       │          <span style=\"color: #00af00; text-decoration-color: #00af00\">0</span> │ attention_1[<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>][<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>] │\n",
       "│ (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">GlobalAveragePool…</span> │                   │            │                   │\n",
       "├─────────────────────┼───────────────────┼────────────┼───────────────────┤\n",
       "│ concatenate         │ (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">1024</span>)      │          <span style=\"color: #00af00; text-decoration-color: #00af00\">0</span> │ global_average_p… │\n",
       "│ (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Concatenate</span>)       │                   │            │ global_average_p… │\n",
       "├─────────────────────┼───────────────────┼────────────┼───────────────────┤\n",
       "│ dense (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Dense</span>)       │ (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">32</span>)        │     <span style=\"color: #00af00; text-decoration-color: #00af00\">32,800</span> │ concatenate[<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>][<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>] │\n",
       "├─────────────────────┼───────────────────┼────────────┼───────────────────┤\n",
       "│ dense_1 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Dense</span>)     │ (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">3</span>)         │         <span style=\"color: #00af00; text-decoration-color: #00af00\">99</span> │ dense[<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>][<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>]       │\n",
       "└─────────────────────┴───────────────────┴────────────┴───────────────────┘\n",
       "</pre>\n"
      ],
      "text/plain": [
       "┏━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓\n",
       "┃\u001b[1m \u001b[0m\u001b[1mLayer (type)       \u001b[0m\u001b[1m \u001b[0m┃\u001b[1m \u001b[0m\u001b[1mOutput Shape     \u001b[0m\u001b[1m \u001b[0m┃\u001b[1m \u001b[0m\u001b[1m   Param #\u001b[0m\u001b[1m \u001b[0m┃\u001b[1m \u001b[0m\u001b[1mConnected to     \u001b[0m\u001b[1m \u001b[0m┃\n",
       "┡━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩\n",
       "│ prompt_padding_mask │ (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m512\u001b[0m)       │          \u001b[38;5;34m0\u001b[0m │ -                 │\n",
       "│ (\u001b[38;5;33mInputLayer\u001b[0m)        │                   │            │                   │\n",
       "├─────────────────────┼───────────────────┼────────────┼───────────────────┤\n",
       "│ prompt_segment_ids  │ (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m512\u001b[0m)       │          \u001b[38;5;34m0\u001b[0m │ -                 │\n",
       "│ (\u001b[38;5;33mInputLayer\u001b[0m)        │                   │            │                   │\n",
       "├─────────────────────┼───────────────────┼────────────┼───────────────────┤\n",
       "│ prompt_input        │ (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m512\u001b[0m)       │          \u001b[38;5;34m0\u001b[0m │ -                 │\n",
       "│ (\u001b[38;5;33mInputLayer\u001b[0m)        │                   │            │                   │\n",
       "├─────────────────────┼───────────────────┼────────────┼───────────────────┤\n",
       "│ response_a_padding… │ (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m512\u001b[0m)       │          \u001b[38;5;34m0\u001b[0m │ -                 │\n",
       "│ (\u001b[38;5;33mInputLayer\u001b[0m)        │                   │            │                   │\n",
       "├─────────────────────┼───────────────────┼────────────┼───────────────────┤\n",
       "│ response_a_segment… │ (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m512\u001b[0m)       │          \u001b[38;5;34m0\u001b[0m │ -                 │\n",
       "│ (\u001b[38;5;33mInputLayer\u001b[0m)        │                   │            │                   │\n",
       "├─────────────────────┼───────────────────┼────────────┼───────────────────┤\n",
       "│ response_a_input    │ (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m512\u001b[0m)       │          \u001b[38;5;34m0\u001b[0m │ -                 │\n",
       "│ (\u001b[38;5;33mInputLayer\u001b[0m)        │                   │            │                   │\n",
       "├─────────────────────┼───────────────────┼────────────┼───────────────────┤\n",
       "│ response_b_padding… │ (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m512\u001b[0m)       │          \u001b[38;5;34m0\u001b[0m │ -                 │\n",
       "│ (\u001b[38;5;33mInputLayer\u001b[0m)        │                   │            │                   │\n",
       "├─────────────────────┼───────────────────┼────────────┼───────────────────┤\n",
       "│ response_b_segment… │ (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m512\u001b[0m)       │          \u001b[38;5;34m0\u001b[0m │ -                 │\n",
       "│ (\u001b[38;5;33mInputLayer\u001b[0m)        │                   │            │                   │\n",
       "├─────────────────────┼───────────────────┼────────────┼───────────────────┤\n",
       "│ response_b_input    │ (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m512\u001b[0m)       │          \u001b[38;5;34m0\u001b[0m │ -                 │\n",
       "│ (\u001b[38;5;33mInputLayer\u001b[0m)        │                   │            │                   │\n",
       "├─────────────────────┼───────────────────┼────────────┼───────────────────┤\n",
       "│ bert_backbone       │ [(\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m512\u001b[0m),     │ \u001b[38;5;34m28,763,648\u001b[0m │ prompt_padding_m… │\n",
       "│ (\u001b[38;5;33mBertBackbone\u001b[0m)      │ (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m512\u001b[0m, \u001b[38;5;34m512\u001b[0m)] │            │ prompt_segment_i… │\n",
       "│                     │                   │            │ prompt_input[\u001b[38;5;34m0\u001b[0m][\u001b[38;5;34m…\u001b[0m │\n",
       "│                     │                   │            │ response_a_paddi… │\n",
       "│                     │                   │            │ response_a_segme… │\n",
       "│                     │                   │            │ response_a_input… │\n",
       "│                     │                   │            │ response_b_paddi… │\n",
       "│                     │                   │            │ response_b_segme… │\n",
       "│                     │                   │            │ response_b_input… │\n",
       "├─────────────────────┼───────────────────┼────────────┼───────────────────┤\n",
       "│ attention           │ (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m512\u001b[0m, \u001b[38;5;34m512\u001b[0m)  │          \u001b[38;5;34m0\u001b[0m │ bert_backbone[\u001b[38;5;34m0\u001b[0m]… │\n",
       "│ (\u001b[38;5;33mAttention\u001b[0m)         │                   │            │ bert_backbone[\u001b[38;5;34m1\u001b[0m]… │\n",
       "├─────────────────────┼───────────────────┼────────────┼───────────────────┤\n",
       "│ attention_1         │ (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m512\u001b[0m, \u001b[38;5;34m512\u001b[0m)  │          \u001b[38;5;34m0\u001b[0m │ bert_backbone[\u001b[38;5;34m0\u001b[0m]… │\n",
       "│ (\u001b[38;5;33mAttention\u001b[0m)         │                   │            │ bert_backbone[\u001b[38;5;34m2\u001b[0m]… │\n",
       "├─────────────────────┼───────────────────┼────────────┼───────────────────┤\n",
       "│ global_average_poo… │ (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m512\u001b[0m)       │          \u001b[38;5;34m0\u001b[0m │ attention[\u001b[38;5;34m0\u001b[0m][\u001b[38;5;34m0\u001b[0m]   │\n",
       "│ (\u001b[38;5;33mGlobalAveragePool…\u001b[0m │                   │            │                   │\n",
       "├─────────────────────┼───────────────────┼────────────┼───────────────────┤\n",
       "│ global_average_poo… │ (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m512\u001b[0m)       │          \u001b[38;5;34m0\u001b[0m │ attention_1[\u001b[38;5;34m0\u001b[0m][\u001b[38;5;34m0\u001b[0m] │\n",
       "│ (\u001b[38;5;33mGlobalAveragePool…\u001b[0m │                   │            │                   │\n",
       "├─────────────────────┼───────────────────┼────────────┼───────────────────┤\n",
       "│ concatenate         │ (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m1024\u001b[0m)      │          \u001b[38;5;34m0\u001b[0m │ global_average_p… │\n",
       "│ (\u001b[38;5;33mConcatenate\u001b[0m)       │                   │            │ global_average_p… │\n",
       "├─────────────────────┼───────────────────┼────────────┼───────────────────┤\n",
       "│ dense (\u001b[38;5;33mDense\u001b[0m)       │ (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m32\u001b[0m)        │     \u001b[38;5;34m32,800\u001b[0m │ concatenate[\u001b[38;5;34m0\u001b[0m][\u001b[38;5;34m0\u001b[0m] │\n",
       "├─────────────────────┼───────────────────┼────────────┼───────────────────┤\n",
       "│ dense_1 (\u001b[38;5;33mDense\u001b[0m)     │ (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m3\u001b[0m)         │         \u001b[38;5;34m99\u001b[0m │ dense[\u001b[38;5;34m0\u001b[0m][\u001b[38;5;34m0\u001b[0m]       │\n",
       "└─────────────────────┴───────────────────┴────────────┴───────────────────┘\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"font-weight: bold\"> Total params: </span><span style=\"color: #00af00; text-decoration-color: #00af00\">28,796,547</span> (109.85 MB)\n",
       "</pre>\n"
      ],
      "text/plain": [
       "\u001b[1m Total params: \u001b[0m\u001b[38;5;34m28,796,547\u001b[0m (109.85 MB)\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"font-weight: bold\"> Trainable params: </span><span style=\"color: #00af00; text-decoration-color: #00af00\">28,796,547</span> (109.85 MB)\n",
       "</pre>\n"
      ],
      "text/plain": [
       "\u001b[1m Trainable params: \u001b[0m\u001b[38;5;34m28,796,547\u001b[0m (109.85 MB)\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"font-weight: bold\"> Non-trainable params: </span><span style=\"color: #00af00; text-decoration-color: #00af00\">0</span> (0.00 B)\n",
       "</pre>\n"
      ],
      "text/plain": [
       "\u001b[1m Non-trainable params: \u001b[0m\u001b[38;5;34m0\u001b[0m (0.00 B)\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "with tpu_strategy.scope():\n",
    "    # Define input layers\n",
    "    prompt_input_ids = keras.Input(shape=(512,), dtype=tf.int32, name='prompt_input')\n",
    "    prompt_segment_ids = keras.Input(shape=(512,), dtype=tf.int32, name='prompt_segment_ids')\n",
    "    prompt_padding_mask = keras.Input(shape=(512,), dtype=tf.int32, name='prompt_padding_mask')\n",
    "\n",
    "    response_a_input_ids = keras.Input(shape=(512,), dtype=tf.int32, name='response_a_input')\n",
    "    response_a_segment_ids = keras.Input(shape=(512,), dtype=tf.int32, name='response_a_segment_ids')\n",
    "    response_a_padding_mask = keras.Input(shape=(512,), dtype=tf.int32, name='response_a_padding_mask')\n",
    "\n",
    "    response_b_input_ids = keras.Input(shape=(512,), dtype=tf.int32, name='response_b_input')\n",
    "    response_b_segment_ids = keras.Input(shape=(512,), dtype=tf.int32, name='response_b_segment_ids')\n",
    "    response_b_padding_mask = keras.Input(shape=(512,), dtype=tf.int32, name='response_b_padding_mask')\n",
    "\n",
    "    # Load BERT encoder\n",
    "    encoder = keras_nlp.models.BertBackbone.from_preset('bert_small_en_uncased')\n",
    "    encoder.trainable = True  # Allow fine-tuning\n",
    "\n",
    "    # Encode inputs\n",
    "    prompt_encoded = encoder({\n",
    "        'token_ids': prompt_input_ids,\n",
    "        'segment_ids': prompt_segment_ids,\n",
    "        'padding_mask': prompt_padding_mask\n",
    "    })['sequence_output']\n",
    "    response_a_encoded = encoder({\n",
    "        'token_ids': response_a_input_ids,\n",
    "        'segment_ids': response_a_segment_ids,\n",
    "        'padding_mask': response_a_padding_mask\n",
    "    })['sequence_output']\n",
    "    response_b_encoded = encoder({\n",
    "        'token_ids': response_b_input_ids,\n",
    "        'segment_ids': response_b_segment_ids,\n",
    "        'padding_mask': response_b_padding_mask\n",
    "    })['sequence_output']\n",
    "    \n",
    "    # Attention on prompt and response_a\n",
    "    attention_a = keras.layers.Attention()([prompt_encoded, response_a_encoded])\n",
    "    attention_a = keras.layers.GlobalAveragePooling1D()(attention_a) \n",
    "    # Attention on prompt and response_b\n",
    "    attention_b = keras.layers.Attention()([prompt_encoded, response_b_encoded])\n",
    "    attention_b = keras.layers.GlobalAveragePooling1D()(attention_b)\n",
    "\n",
    "    # Combine attentions\n",
    "    combined_attention = keras.layers.Concatenate(axis=-1)([attention_a, attention_b])\n",
    "\n",
    "    # Output layers\n",
    "    # x = keras.layers.GlobalAveragePooling1D()(combined_attention)\n",
    "    x = keras.layers.Dense(32, activation='relu')(combined_attention)\n",
    "    # x = keras.layers.Dropout(0.5)(x)  # Add dropout for regularization\n",
    "    outputs = keras.layers.Dense(3, activation='softmax')(x)\n",
    "\n",
    "    # Create and compile model\n",
    "    model = keras.Model(\n",
    "        inputs=[\n",
    "            prompt_input_ids, prompt_segment_ids, prompt_padding_mask,\n",
    "            response_a_input_ids, response_a_segment_ids, response_a_padding_mask,\n",
    "            response_b_input_ids, response_b_segment_ids, response_b_padding_mask\n",
    "        ],\n",
    "        outputs=outputs\n",
    "    )\n",
    "    model.compile(\n",
    "        optimizer=keras.optimizers.Adam(learning_rate=(5e-6)),  # Adjusted learning rate\n",
    "        loss=keras.losses.CategoricalCrossentropy(),\n",
    "        metrics=[\"accuracy\"],\n",
    "    )\n",
    "\n",
    "    model.summary()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "8e036cc4",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-08-05T02:36:18.856499Z",
     "iopub.status.busy": "2024-08-05T02:36:18.855789Z",
     "iopub.status.idle": "2024-08-05T02:36:18.859531Z",
     "shell.execute_reply": "2024-08-05T02:36:18.858863Z"
    },
    "papermill": {
     "duration": 0.013878,
     "end_time": "2024-08-05T02:36:18.860957",
     "exception": false,
     "start_time": "2024-08-05T02:36:18.847079",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# !pip install -q pydot\n",
    "# from tensorflow.keras.utils import plot_model\n",
    "\n",
    "# # Plot the model\n",
    "# plot_model(model, to_file='model_plot.png', show_shapes=True, show_layer_names=True)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cf052c43",
   "metadata": {
    "papermill": {
     "duration": 0.007348,
     "end_time": "2024-08-05T02:36:18.876088",
     "exception": false,
     "start_time": "2024-08-05T02:36:18.868740",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Training"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "7ea9bd29",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-08-05T02:36:18.892580Z",
     "iopub.status.busy": "2024-08-05T02:36:18.892343Z",
     "iopub.status.idle": "2024-08-05T03:19:41.443920Z",
     "shell.execute_reply": "2024-08-05T03:19:41.442341Z"
    },
    "papermill": {
     "duration": 2602.563063,
     "end_time": "2024-08-05T03:19:41.446708",
     "exception": false,
     "start_time": "2024-08-05T02:36:18.883645",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/usr/local/lib/python3.10/site-packages/keras/src/optimizers/base_optimizer.py:664: UserWarning: Gradients do not exist for variables ['kernel', 'bias'] when minimizing the loss. If using `model.compile()`, did you forget to provide a `loss` argument?\n",
      "  warnings.warn(\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2024-08-05 02:36:58.010323: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] model_pruner failed: INVALID_ARGUMENT: Graph does not contain terminal node StatefulPartitionedCall.\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "I0000 00:00:1722825421.940790     873 tpu_compilation_cache_interface.cc:441] TPU host compilation cache miss: cache_key(11feaa8e96e83154:0:0), session_name()\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "I0000 00:00:1722825439.410745     873 tpu_compile_op_common.cc:245] Compilation of 11feaa8e96e83154:0:0 with session name  took 17.469912703s and succeeded\n",
      "I0000 00:00:1722825439.494901     873 tpu_compilation_cache_interface.cc:475] TPU host compilation cache: compilation complete for cache_key(11feaa8e96e83154:0:0), session_name(), subgraph_key(std::string(property.function_name) = \"cluster_one_step_on_iterator_6212108580886331120\", property.function_library_fingerprint = 15740532463245447721, property.mlir_module_fingerprint = 0, property.num_replicas = 8, topology.chip_bounds().x = 2, topology.chip_bounds().y = 2, topology.chip_bounds().z = 1, topology.wrap().x = false, topology.wrap().y = false, topology.wrap().z = false, std::string(property.shapes_prefix) = \"8,3,;8,512,;8,512,;8,512,;8,512,;8,512,;8,512,;8,512,;8,512,;8,512,;\", property.guaranteed_constants_size = 0, embedding_partitions_fingerprint = \"1688352644216761960\")\n",
      "I0000 00:00:1722825439.494948     873 tpu_compilation_cache_interface.cc:541] After adding entry for key 11feaa8e96e83154:0:0 with session_name  cache is 1 entries (194344233 bytes),  marked for eviction 0 entries (0 bytes).\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "I0000 00:00:1722825514.019591     896 tpu_compilation_cache_interface.cc:441] TPU host compilation cache miss: cache_key(a70f8052f4731787:0:0), session_name()\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "I0000 00:00:1722825528.167665     896 tpu_compile_op_common.cc:245] Compilation of a70f8052f4731787:0:0 with session name  took 14.14802878s and succeeded\n",
      "I0000 00:00:1722825528.244231     896 tpu_compilation_cache_interface.cc:475] TPU host compilation cache: compilation complete for cache_key(a70f8052f4731787:0:0), session_name(), subgraph_key(std::string(property.function_name) = \"cluster_one_step_on_iterator_6212108580886331120\", property.function_library_fingerprint = 15740532463245447721, property.mlir_module_fingerprint = 0, property.num_replicas = 8, topology.chip_bounds().x = 2, topology.chip_bounds().y = 2, topology.chip_bounds().z = 1, topology.wrap().x = false, topology.wrap().y = false, topology.wrap().z = false, std::string(property.shapes_prefix) = \"4,3,;4,512,;4,512,;4,512,;4,512,;4,512,;4,512,;4,512,;4,512,;4,512,;\", property.guaranteed_constants_size = 0, embedding_partitions_fingerprint = \"1688352644216761960\")\n",
      "I0000 00:00:1722825528.244280     896 tpu_compilation_cache_interface.cc:541] After adding entry for key a70f8052f4731787:0:0 with session_name  cache is 2 entries (370585284 bytes),  marked for eviction 0 entries (0 bytes).\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2024-08-05 02:38:53.563854: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] model_pruner failed: INVALID_ARGUMENT: Graph does not contain terminal node AssignVariableOp.\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "I0000 00:00:1722825534.375594     832 tpu_compilation_cache_interface.cc:441] TPU host compilation cache miss: cache_key(f31a15216694541:0:0), session_name()\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "I0000 00:00:1722825538.089907     832 tpu_compile_op_common.cc:245] Compilation of f31a15216694541:0:0 with session name  took 3.714260631s and succeeded\n",
      "I0000 00:00:1722825538.113500     832 tpu_compilation_cache_interface.cc:475] TPU host compilation cache: compilation complete for cache_key(f31a15216694541:0:0), session_name(), subgraph_key(std::string(property.function_name) = \"cluster_one_step_on_iterator_3447813239702658168\", property.function_library_fingerprint = 3685828981908808350, property.mlir_module_fingerprint = 0, property.num_replicas = 8, topology.chip_bounds().x = 2, topology.chip_bounds().y = 2, topology.chip_bounds().z = 1, topology.wrap().x = false, topology.wrap().y = false, topology.wrap().z = false, std::string(property.shapes_prefix) = \"8,3,;8,512,;8,512,;8,512,;8,512,;8,512,;8,512,;8,512,;8,512,;8,512,;\", property.guaranteed_constants_size = 0, embedding_partitions_fingerprint = \"1688352644216761960\")\n",
      "I0000 00:00:1722825538.113534     832 tpu_compilation_cache_interface.cc:541] After adding entry for key f31a15216694541:0:0 with session_name  cache is 3 entries (410729707 bytes),  marked for eviction 0 entries (0 bytes).\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "I0000 00:00:1722825544.955244     880 tpu_compilation_cache_interface.cc:441] TPU host compilation cache miss: cache_key(7392c284e424d27d:0:0), session_name()\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "I0000 00:00:1722825548.431475     880 tpu_compile_op_common.cc:245] Compilation of 7392c284e424d27d:0:0 with session name  took 3.476194487s and succeeded\n",
      "I0000 00:00:1722825548.450209     880 tpu_compilation_cache_interface.cc:475] TPU host compilation cache: compilation complete for cache_key(7392c284e424d27d:0:0), session_name(), subgraph_key(std::string(property.function_name) = \"cluster_one_step_on_iterator_3447813239702658168\", property.function_library_fingerprint = 3685828981908808350, property.mlir_module_fingerprint = 0, property.num_replicas = 8, topology.chip_bounds().x = 2, topology.chip_bounds().y = 2, topology.chip_bounds().z = 1, topology.wrap().x = false, topology.wrap().y = false, topology.wrap().z = false, std::string(property.shapes_prefix) = \"5,3,;5,512,;5,512,;5,512,;5,512,;5,512,;5,512,;5,512,;5,512,;5,512,;\", property.guaranteed_constants_size = 0, embedding_partitions_fingerprint = \"1688352644216761960\")\n",
      "I0000 00:00:1722825548.450236     880 tpu_compilation_cache_interface.cc:541] After adding entry for key 7392c284e424d27d:0:0 with session_name  cache is 4 entries (450097256 bytes),  marked for eviction 0 entries (0 bytes).\n"
     ]
    }
   ],
   "source": [
    "# Callbacks for early stopping and learning rate reduction\n",
    "early_stopping = keras.callbacks.EarlyStopping(monitor='val_loss', patience=7, restore_best_weights=True)\n",
    "reduce_lr = keras.callbacks.ReduceLROnPlateau(monitor='val_loss', factor=0.2, patience=3, min_lr=0.0)\n",
    "\n",
    "# Train the model with early stopping and learning rate reduction\n",
    "history = model.fit(train_dataset, validation_data=val_dataset, epochs=100, callbacks=[early_stopping], verbose=0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "9cf376bd",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-08-05T03:19:41.474255Z",
     "iopub.status.busy": "2024-08-05T03:19:41.473906Z",
     "iopub.status.idle": "2024-08-05T03:19:41.685709Z",
     "shell.execute_reply": "2024-08-05T03:19:41.684823Z"
    },
    "papermill": {
     "duration": 0.231291,
     "end_time": "2024-08-05T03:19:41.687527",
     "exception": false,
     "start_time": "2024-08-05T03:19:41.456236",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "image/png": "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AMbANDg4mOnTp7NgwQJq165NWFgYc+fOlfwfUeNIDpAQokx9+vTh7Nmz/PHHH6xZs4YFCxYwe/Zs5s2bx+TJkwGYNm0aQ4cOZeXKlURERPDqq68yc+ZMNmzYQGhoaIXH4OzszPDhw1mxYgVffvkl8fHxbN++nffee894jl6vB+C5554jLCys2Os0a9asyNeurq7lur9er6ddu3Z88sknxT4fFBRUrutYW0mzWYqiGB/PmjWLCRMmGP97Pv3008ycOZNdu3aVmQguRHUhAZAQNVSdOnVwc3Pj5MmTtzx34sQJtFptkV/qfn5+PPzwwzz88MOkpqbSp08f3njjDWMABNC0aVOeffZZnn32WU6fPk3Hjh2ZNWsWP/zwQ7FjaNSoEUCJY6hduzbu7u7GY/fffz/fffcd69ev5/jx4yiKYlz+AoxLSY6OjgwcONDE70jpmjZtysGDBxkwYMAty07FKW658NSpU7i5uVGnTh2Acn//mzZtWmSXmyW0a9eOdu3a8corr7Bjxw569erFvHnzeOeddyx6HyHslSyBCVFD6XQ67rzzTv74448iW9Xj4+NZunQpt99+O15eXgBcu3atyGs9PDxo1qyZcft3eno6mZmZRc5p2rQpnp6et2wRL6xevXp07NiR7777jsTEROPxI0eOsGbNGu66664i5w8cOBA/Pz9+/vlnfv75Z7p161ZkCatu3br069eP+fPnExsbe8v9rl69Wvo3pRSjR4/m0qVLfPPNN7c8l5GRccsOsp07d7J//37j1zExMfzxxx/ceeed6HQ6k77/I0eO5ODBg6xYseKWexee2SmP5ORkcnNzixxr164dWq221P9WQlQ3MgMkRDW3cOFC/vnnn1uO//e//+Wdd95h7dq13H777TzxxBM4ODgwf/58srKy+PDDD43ntm7dmn79+tG5c2f8/PzYt28fv/76K08++SSgzmwMGDCA0aNH07p1axwcHFixYgXx8fE88MADpY7vo48+Ijw8nB49ejBp0iTjNnhvb2/eeOONIuc6Ojpy7733smzZMtLS0vj4449vud7cuXO5/fbbadeuHY888ghNmjQhPj6enTt3cvHiRQ4ePGjGdxEeeughli9fzpQpU9i4cSO9evUiLy+PEydOsHz5ciIiIujSpYvx/LZt2xIWFlZkGzzAm2++aTynvN//559/nl9//ZVRo0Yx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",
      "text/plain": [
       "<Figure size 640x480 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Plot the training and validation loss\n",
    "plt.plot(history.history['loss'], label='Training Loss')\n",
    "plt.plot(history.history['val_loss'], label='Validation Loss')\n",
    "plt.title('Loss over epochs')\n",
    "plt.xlabel('Epochs')\n",
    "plt.ylabel('Loss')\n",
    "plt.legend()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f6359784",
   "metadata": {
    "papermill": {
     "duration": 0.009277,
     "end_time": "2024-08-05T03:19:41.706343",
     "exception": false,
     "start_time": "2024-08-05T03:19:41.697066",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Predict"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "72b90ec2",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-08-05T03:19:41.725761Z",
     "iopub.status.busy": "2024-08-05T03:19:41.725438Z",
     "iopub.status.idle": "2024-08-05T03:19:41.746672Z",
     "shell.execute_reply": "2024-08-05T03:19:41.745666Z"
    },
    "papermill": {
     "duration": 0.033351,
     "end_time": "2024-08-05T03:19:41.748421",
     "exception": false,
     "start_time": "2024-08-05T03:19:41.715070",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>prompt</th>\n",
       "      <th>response_a</th>\n",
       "      <th>response_b</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>136060</td>\n",
       "      <td>I have three oranges today, I ate an orange ye...</td>\n",
       "      <td>You have two oranges today.</td>\n",
       "      <td>You still have three oranges. Eating an orange...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>211333</td>\n",
       "      <td>You are a mediator in a heated political debat...</td>\n",
       "      <td>Thank you for sharing the details of the situa...</td>\n",
       "      <td>Mr Reddy and Ms Blue both have valid points in...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1233961</td>\n",
       "      <td>How to initialize the classification head when...</td>\n",
       "      <td>When you want to initialize the classification...</td>\n",
       "      <td>To initialize the classification head when per...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        id                                             prompt  \\\n",
       "0   136060  I have three oranges today, I ate an orange ye...   \n",
       "1   211333  You are a mediator in a heated political debat...   \n",
       "2  1233961  How to initialize the classification head when...   \n",
       "\n",
       "                                          response_a  \\\n",
       "0                        You have two oranges today.   \n",
       "1  Thank you for sharing the details of the situa...   \n",
       "2  When you want to initialize the classification...   \n",
       "\n",
       "                                          response_b  \n",
       "0  You still have three oranges. Eating an orange...  \n",
       "1  Mr Reddy and Ms Blue both have valid points in...  \n",
       "2  To initialize the classification head when per...  "
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Load Test Data\n",
    "test_df = pd.read_csv(base_dir + 'test.csv')\n",
    "\n",
    "# Parse String and Ensure all text data is encoded to UTF-8\n",
    "for col in [i for i in test_df.columns if i in ['prompt', 'response_a', 'response_b']]:\n",
    "    test_df[col] = test_df[col].map(lambda x: eval(x.replace(\"null\", \"''\"))[0])\n",
    "    test_df[col] = test_df[col].apply(lambda x: str(x).encode('utf-8', errors='ignore').decode('utf-8'))\n",
    "\n",
    "# Show Sample\n",
    "test_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "9751221e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-08-05T03:19:41.767639Z",
     "iopub.status.busy": "2024-08-05T03:19:41.767388Z",
     "iopub.status.idle": "2024-08-05T03:19:43.974323Z",
     "shell.execute_reply": "2024-08-05T03:19:43.973427Z"
    },
    "papermill": {
     "duration": 2.21919,
     "end_time": "2024-08-05T03:19:43.976607",
     "exception": false,
     "start_time": "2024-08-05T03:19:41.757417",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# Build Test Dataset\n",
    "test_dataset = build_dataset(\n",
    "    prompts=test_df.prompt.tolist(),\n",
    "    responses_a=test_df.response_a.tolist(),\n",
    "    responses_b=test_df.response_b.tolist(),\n",
    "    labels=None,\n",
    "    batch_size=64,\n",
    "    shuffle=False\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "2cb54ddf",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-08-05T03:19:43.997853Z",
     "iopub.status.busy": "2024-08-05T03:19:43.997553Z",
     "iopub.status.idle": "2024-08-05T03:19:54.548520Z",
     "shell.execute_reply": "2024-08-05T03:19:54.547497Z"
    },
    "papermill": {
     "duration": 10.563634,
     "end_time": "2024-08-05T03:19:54.550319",
     "exception": false,
     "start_time": "2024-08-05T03:19:43.986685",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2024-08-05 03:19:50.532259: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:961] model_pruner failed: INVALID_ARGUMENT: Graph does not contain terminal node functional_1/bert_backbone_1/embeddings_layer_norm_1/Reshape/ReadVariableOp.\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "I0000 00:00:1722827991.202753     840 tpu_compilation_cache_interface.cc:441] TPU host compilation cache miss: cache_key(2c0c1945942025e7:0:0), session_name()\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\r",
      "\u001b[1m1/1\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 10s/step"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r",
      "\u001b[1m1/1\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m10s\u001b[0m 10s/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "I0000 00:00:1722827994.440617     840 tpu_compile_op_common.cc:245] Compilation of 2c0c1945942025e7:0:0 with session name  took 3.237809335s and succeeded\n",
      "I0000 00:00:1722827994.465062     840 tpu_compilation_cache_interface.cc:475] TPU host compilation cache: compilation complete for cache_key(2c0c1945942025e7:0:0), session_name(), subgraph_key(std::string(property.function_name) = \"cluster_one_step_on_data_distributed_10048679654413227853\", property.function_library_fingerprint = 3856142233146699390, property.mlir_module_fingerprint = 0, property.num_replicas = 8, topology.chip_bounds().x = 2, topology.chip_bounds().y = 2, topology.chip_bounds().z = 1, topology.wrap().x = false, topology.wrap().y = false, topology.wrap().z = false, std::string(property.shapes_prefix) = \"2,512,;2,512,;2,512,;2,512,;2,512,;2,512,;2,512,;2,512,;2,512,;\", property.guaranteed_constants_size = 0, embedding_partitions_fingerprint = \"1688352644216761960\")\n",
      "I0000 00:00:1722827994.465120     840 tpu_compilation_cache_interface.cc:541] After adding entry for key 2c0c1945942025e7:0:0 with session_name  cache is 5 entries (489295497 bytes),  marked for eviction 0 entries (0 bytes).\n"
     ]
    }
   ],
   "source": [
    "test_pred = model.predict(test_dataset)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "882ee133",
   "metadata": {
    "papermill": {
     "duration": 0.009087,
     "end_time": "2024-08-05T03:19:54.569688",
     "exception": false,
     "start_time": "2024-08-05T03:19:54.560601",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Submission"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "c6a44d98",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-08-05T03:19:54.589040Z",
     "iopub.status.busy": "2024-08-05T03:19:54.588765Z",
     "iopub.status.idle": "2024-08-05T03:19:54.603496Z",
     "shell.execute_reply": "2024-08-05T03:19:54.602678Z"
    },
    "papermill": {
     "duration": 0.026297,
     "end_time": "2024-08-05T03:19:54.604956",
     "exception": false,
     "start_time": "2024-08-05T03:19:54.578659",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>winner_model_a</th>\n",
       "      <th>winner_model_b</th>\n",
       "      <th>winner_tie</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>136060</td>\n",
       "      <td>0.262594</td>\n",
       "      <td>0.315013</td>\n",
       "      <td>0.422393</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>211333</td>\n",
       "      <td>0.472081</td>\n",
       "      <td>0.239687</td>\n",
       "      <td>0.288232</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1233961</td>\n",
       "      <td>0.291873</td>\n",
       "      <td>0.420687</td>\n",
       "      <td>0.287440</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        id  winner_model_a  winner_model_b  winner_tie\n",
       "0   136060        0.262594        0.315013    0.422393\n",
       "1   211333        0.472081        0.239687    0.288232\n",
       "2  1233961        0.291873        0.420687    0.287440"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "submission_df = test_df[[\"id\"]].copy()\n",
    "submission_df[['winner_model_a', 'winner_model_b', 'winner_tie']] = test_pred.tolist()\n",
    "submission_df.to_csv(\"submission.csv\", index=False)\n",
    "submission_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4e9de4f9",
   "metadata": {
    "papermill": {
     "duration": 0.009014,
     "end_time": "2024-08-05T03:19:54.623187",
     "exception": false,
     "start_time": "2024-08-05T03:19:54.614173",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "tpu1vmV38",
   "dataSources": [
    {
     "databundleVersionId": 8346466,
     "sourceId": 66631,
     "sourceType": "competition"
    },
    {
     "modelId": 2819,
     "modelInstanceId": 4675,
     "sourceId": 6054,
     "sourceType": "modelInstanceVersion"
    },
    {
     "modelId": 2819,
     "modelInstanceId": 4676,
     "sourceId": 6055,
     "sourceType": "modelInstanceVersion"
    },
    {
     "modelId": 2819,
     "modelInstanceId": 4678,
     "sourceId": 6057,
     "sourceType": "modelInstanceVersion"
    },
    {
     "modelId": 2819,
     "modelInstanceId": 4679,
     "sourceId": 6058,
     "sourceType": "modelInstanceVersion"
    }
   ],
   "dockerImageVersionId": 30746,
   "isGpuEnabled": false,
   "isInternetEnabled": true,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.14"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 2684.032785,
   "end_time": "2024-08-05T03:20:02.839456",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2024-08-05T02:35:18.806671",
   "version": "2.6.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
